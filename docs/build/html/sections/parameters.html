
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Input Parameters &#8212; HELIOS 3.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Code Structure" href="structure.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="input-parameters">
<h1><strong>Input Parameters</strong><a class="headerlink" href="#input-parameters" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-info">
<h2>General Info<a class="headerlink" href="#general-info" title="Permalink to this headline">¶</a></h2>
<p>All input parameters and settings are given in the file <code class="docutils literal notranslate"><span class="pre">param.dat</span></code>. Next to each setting, the parameter format, typical values and units are given in square brackets. Furthermore, if (CL: Y) the setting exists as command-line option. If (CL: N) it does not. The command-line option has the <strong>same name</strong> as the respective parameter given in <code class="docutils literal notranslate"><span class="pre">param.dat</span></code> with the following limitations:</p>
<ul class="simple">
<li><p>small letters only</p></li>
<li><p>all spaces and dash symbols are replaced by an underscore</p></li>
<li><p>without the square brackets and their content</p></li>
<li><p>no dependency information (parameter name starts after the arrow)</p></li>
</ul>
<p>Examples:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TOA</span> <span class="pre">pressure</span> <span class="pre">[10^-6</span> <span class="pre">bar]</span></code> becomes <code class="docutils literal notranslate"><span class="pre">-toa_pressure</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">manual</span> <span class="pre">--&gt;</span> <span class="pre">surface</span> <span class="pre">gravity</span> <span class="pre">[cm</span> <span class="pre">s^-2]</span></code> becomes <code class="docutils literal notranslate"><span class="pre">-surface_gravity</span></code></p></li>
</ul>
</div></blockquote>
<p>Note that the command-line options <strong>overwrite</strong> the values in the parameter file. The parameter file can be given an own name and loaded with the command-line option <code class="docutils literal notranslate"><span class="pre">-parameter_file</span></code>. In this way, settings can be saved to be reused or for reference.</p>
</div>
<div class="section" id="parameter-file">
<h2>Parameter File<a class="headerlink" href="#parameter-file" title="Permalink to this headline">¶</a></h2>
<p><strong>IMPORTANT:</strong> The parameter file has been extensively revised for version 3 of HELIOS. Old parameter files, saved from earlier versions, <strong>are not compatible anymore</strong> and will lead to errors.</p>
<p>Below each of the settings in the parameter file is explained in detail.</p>
<div class="section" id="general">
<h3>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">name</span>&#160;&#160; <span class="pre">[any</span> <span class="pre">string]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The name of the output. The output directory is given this name and all output files begin with this prefix.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">output</span> <span class="pre">directory</span>&#160;&#160; <span class="pre">[directory</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The main output directory that contains all sub-directories with the output. This is useful for chain runs or when running multiple instances of the code in parallel.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">realtime</span> <span class="pre">plotting</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no,</span> <span class="pre">number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If set to ‘yes’, a pop-up window with the real-time T-P profile is shown during the run. During the convective adjustment loop it additionally shows the next flux. Per default the window is updated every 100th iteration step. The plotting interval can be changed by providing a number instead of ‘yes’.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">planet</span> <span class="pre">type</span>&#160;&#160; <span class="pre">[rocky,</span> <span class="pre">gas,</span> <span class="pre">no_atmosphere]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This setting this determines the zero altitude location. For ‘rocky’ it is simply the surface of the planet. For ‘gas’ zero is set at 10 bar. This is really only relevant when using the azimuth angle correction. Because the code in general uses pressure as vertical grid unit. The setting ‘no_atmosphere’ is special. In this case the code runs a bare-rock scenario with a negligibly thin atmosphere. The surface temperature and the spectrum are then the output quantities of interest. (You will want to use a non-gray surface in that case, otherwise the spectrum will not be that interesting.)</p>
</div>
<div class="section" id="grid">
<h3>Grid<a class="headerlink" href="#grid" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">TOA</span> <span class="pre">pressure</span> <span class="pre">[10^-6</span> <span class="pre">bar]</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The Top-of-atmosphere pressure in cgs units. Specifically this is the value in the center of the uppermost atmospheric layer. Typically this is 1e-1 for most applications.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">BOA</span> <span class="pre">pressure</span> <span class="pre">[10^-6</span> <span class="pre">bar]</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The Bottom-of-atmosphere pressure in cgs units. Specifically this is the value at the lowest interface of the numerical grid. For rocky planets this coincides with the surface. For gas planets typical values are 1e8 or 1e9.</p>
</div>
<div class="section" id="iteration">
<h3>Iteration<a class="headerlink" href="#iteration" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">run</span> <span class="pre">type</span>&#160;&#160; <span class="pre">[iterative,</span> <span class="pre">post-processing]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the run type. In ‘iterative’ mode the code starts from an isothermal T-P profile and runs until radiative-convective equilibrium is found. In ‘post-processing’ mode the code starts from a given T-P profile (a file is required as input) and only runs once through the atmosphere. This mode is used to produce a higher resolution spectrum than would be feasible with the ‘iterative’ mode.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">to</span> <span class="pre">temperature</span> <span class="pre">file</span>&#160;&#160; <span class="pre">[file</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the file with T-P profile, needed for the post-processing mode. <em>This parameter is only used if ‘post-processing’ is set previously.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">temperature</span> <span class="pre">file</span> <span class="pre">format</span>&#160;&#160; <span class="pre">[helios,</span> <span class="pre">TP</span> <span class="pre">(bar),</span> <span class="pre">PT</span> <span class="pre">(bar)]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">N)</span></code></p>
</div></blockquote>
<p>This sets the format of the T-P profile file. Choose ‘helios’ for a file generated by HELIOS. Otherwise a text file with two columns is possible too. The column order is then set via ‘PT’ or ‘TP’. Per default, cgs units are expected, but bar is possible if ‘bar’ is added as second parameter on this line. <em>This parameter is only used if ‘post-processing’ is set for the run type.</em></p>
</div>
<div class="section" id="radiation">
<h3>Radiation<a class="headerlink" href="#radiation" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">scattering</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Enables or disables scattering. This setting affects both, gaseous as well as scattering due to aerosols (if clouds are switched on).</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">direct</span> <span class="pre">irradiation</span> <span class="pre">beam</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If ‘yes’, star is treated as a point source the location of which is set by the zenith angle setting. If ‘no’, the stellar irradiation is represented by the downward flux at TOA. The direct beam approach is usually used if the irradiation angle is important or a specific location on the planet is to be modeled. To simulate averaged conditions of the irradiated hemisphere (i.e., the dayside of a tidally-locked planet), the direct beam is not required.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">factor</span>&#160;&#160; <span class="pre">[number:</span> <span class="pre">0.25</span> <span class="pre">--</span> <span class="pre">1]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Determines the overall heat content (and brightness) of the planetary dayside by modifying the amount of incoming stellar radiation. This parameter is usually used as a proxy to describe how much heat is transported from the dayside to the nightside of a planet via horizontal advection. For no day-to-night heat transport choose f = 2/3 (e.g., see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008ApJS..179..484H/">Hansen 2008</a>) and for efficient global redistribution choose f = 1/4. Substellar point conditions can be simulated with f = 1. <em>This parameter is only used if ‘no’ is set for the direct irradiation beam.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">stellar</span> <span class="pre">zenith</span> <span class="pre">angle</span> <span class="pre">[deg]</span>&#160;&#160; <span class="pre">[number:</span> <span class="pre">0</span> <span class="pre">--</span> <span class="pre">89]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The stellar zenith angle in degrees, measured from the vertical. Vertical irradiation (= substellar point): 0. Horizontal irradiation (= terminator): 90. The code will take min[chosen angle, 89] for numerical stability and since exactly horizontal irradiation is not possible anyway. <em>This parameter is only used if ‘yes’ is set for the direct irradiation beam.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">internal</span> <span class="pre">temperature</span> <span class="pre">[K]</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The internal heat flux at the BOA is given by blackbody radiation of this temperature. For older, fully evolved planets: hot Jupiters T_int 50 – 100 K, sub-Neptunes/terrestrial planets T_int ~ 0 – 50 K. Young planets T_int &gt;~ 100 K.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">surface</span> <span class="pre">albedo</span>&#160;&#160; <span class="pre">[file,</span> <span class="pre">number:</span> <span class="pre">0</span> <span class="pre">--</span> <span class="pre">1]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The surface albedo value can be set as constant value (= gray, wavelength-independent albedo) or read from a file. For gas planets this should be left at 0.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">to</span> <span class="pre">albedo</span> <span class="pre">file</span>&#160;&#160; <span class="pre">[path</span> <span class="pre">to</span> <span class="pre">file]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the file with the surface albedo. <em>This parameter is only used if ‘file’ is set for the surface albedo.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">albedo</span> <span class="pre">file</span> <span class="pre">format</span>&#160;&#160; <span class="pre">[#</span> <span class="pre">skip</span> <span class="pre">lines,</span> <span class="pre">wavelength</span> <span class="pre">column,</span> <span class="pre">wavelength</span> <span class="pre">unit</span> <span class="pre">[micron,</span> <span class="pre">cm,</span> <span class="pre">m]]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">N)</span></code></p>
</div></blockquote>
<p>This sets the albedo file format via three parameters. First parameter determines how many lines are skipped at the beginning of the file. The second sets the name (header) of the column with the wavelength values. The third sets the wavelength unit with possible options being ‘micron’, ‘cm’ and ‘m’. <em>This parameter is only used if ‘file’ is set for the surface albedo.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">surface</span> <span class="pre">name</span>&#160;&#160; <span class="pre">[header</span> <span class="pre">for</span> <span class="pre">column</span> <span class="pre">with</span> <span class="pre">surface</span> <span class="pre">data]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the name (header) of the column with the albedo data. <em>This parameter is only used if ‘file’ is set for the surface albedo.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">f</span> <span class="pre">approximation</span> <span class="pre">formula</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If enabled, calculates the f factor with Eq. (10) of Koll (2021) based on the longwave optical depth of the atmosphere.  As the optical depth depends on atmospheric properties, please run the model ~ 4 times in sequence to have a converged solution. This overwrites the manual f factor setting. <em>This parameter is only used if the planet type is set to ‘rocky’.</em></p>
</div>
<div class="section" id="opacity-mixing">
<h3>Opacity Mixing<a class="headerlink" href="#opacity-mixing" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">opacity</span> <span class="pre">mixing</span>&#160;&#160; <span class="pre">[premixed,</span> <span class="pre">on-the-fly]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If set to ‘premixed’, a single, premixed opacity table is used. Otherwise, with ‘on-the-fly’ an individual opacity file is read for each species and the opacities are then mixed during the iteration.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">to</span> <span class="pre">opacity</span> <span class="pre">file</span>&#160;&#160; <span class="pre">[file</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the HDF5 file with the premixed opacity. <em>This parameter is only used if ‘premixed’ is set for the opacity mixing.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">to</span> <span class="pre">species</span> <span class="pre">file</span>&#160;&#160; <span class="pre">[file</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the file that defines the species and the source of their mixing ratios. <em>This parameter is only used if ‘on-the-fly’ is set for the opacity mixing.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">with</span> <span class="pre">vertical</span> <span class="pre">mixing</span> <span class="pre">ratios</span>&#160;&#160; <span class="pre">[file</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the file with the vertical volume mixing ratios. This file is only needed if it is used for at least one species, as defined in the species file. <em>This parameter is only used if ‘on-the-fly’ is set for the opacity mixing.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">vertical</span> <span class="pre">VMR</span> <span class="pre">file</span> <span class="pre">format</span>&#160;&#160; <span class="pre">[#</span> <span class="pre">header</span> <span class="pre">lines,</span> <span class="pre">pressure</span> <span class="pre">column,</span> <span class="pre">pressure</span> <span class="pre">unit</span> <span class="pre">[cgs,</span> <span class="pre">Pa,</span> <span class="pre">bar]]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">N)</span></code></p>
</div></blockquote>
<p>This sets the format of the file with the vertical volume mixing ratios. First parameter determines how many lines are skipped at the beginning of the file. The second sets the name (header) of the column with the pressure grid. The third sets the pressure unit with possible options being ‘cgs’, ‘Pa’ and ‘bar’. <em>This parameter is only used if ‘on-the-fly’ is set for the opacity mixing.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">directory</span> <span class="pre">with</span> <span class="pre">FastChem</span> <span class="pre">files</span>&#160;&#160; <span class="pre">[directory</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the directory where the FastChem files, the two files named <code class="docutils literal notranslate"><span class="pre">chem_low.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">chem_high.dat</span></code>, are located. This is only needed if FastChem is set as mixing ratio source for at least one species in the species file. <em>This parameter is only used if ‘on-the-fly’ is set for the opacity mixing.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">directory</span> <span class="pre">with</span> <span class="pre">opacity</span> <span class="pre">files</span>&#160;&#160; <span class="pre">[directory</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the directory where the individual opacity files are located. <em>This parameter is only used if ‘on-the-fly’ is set for the opacity mixing.</em></p>
</div>
<div class="section" id="convective-adjustment">
<h3>Convective Adjustment<a class="headerlink" href="#convective-adjustment" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">convective</span> <span class="pre">adjustment</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Switches convective adjustment on or off. If switched off, only radiative equilibrium is determined by the code and convective adjustment is not performed. If switched on, the solution is in radiative-convective equilibrium (which is usually the desired goal).</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">kappa</span> <span class="pre">value</span>&#160;&#160; <span class="pre">[file,</span> <span class="pre">number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the value of the adiabatic coefficient kappa, also called ‘delad’. If set to ‘file’, a file with pre-tabulated kappa values is read, otherwise a constant value can be set too. For a diatomic gas, one can approximate kappa via the ideal gas law with 2/7 = 0.285714 (for a diatomic gas) or with 2/8 = 0.25 (for a tri-atomic gas).</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">kappa</span> <span class="pre">file</span> <span class="pre">path</span>&#160;&#160; <span class="pre">[file</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the file with the pre-tabulated kappa and c_p values. Note that the format of this file is not user-defined but follows strict rules. See <a class="reference internal" href="tutorial.html#kappa-file-format"><span class="std std-ref">Using Pre-Tabulated kappa and c_p</span></a> for more info. <em>This parameter is only used if ‘file’ is set for the kappa value.</em></p>
</div>
<div class="section" id="stellar-and-planetary-parameters">
<h3>Stellar and Planetary Parameters<a class="headerlink" href="#stellar-and-planetary-parameters" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">stellar</span> <span class="pre">spectral</span> <span class="pre">model</span>&#160;&#160; <span class="pre">[blackbody,</span> <span class="pre">file]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>With ‘blackbody’ the star is treated as a blackbody of given temperature (set further below) and the stellar spectrum is calculated within HELIOS. With ‘file’ the stellar spectrum is read from a file.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">to</span> <span class="pre">stellar</span> <span class="pre">spectrum</span> <span class="pre">file</span>&#160;&#160; <span class="pre">[file</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the HDF5 file containing the stellar spectrum. <em>This parameter is only used if ‘file’ is set for the stellar spectral model.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">dataset</span> <span class="pre">in</span> <span class="pre">stellar</span> <span class="pre">spectrum</span> <span class="pre">file</span>&#160;&#160; <span class="pre">[dataset]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the dataset in the stellar spectrum file where the desired stellar spectrum is stored. <em>This parameter is only used if ‘file’ is set for the stellar spectral model.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">planet</span>&#160;&#160; <span class="pre">[manual,</span> <span class="pre">name</span> <span class="pre">of</span> <span class="pre">planet]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>With ‘manual’, the system parameters are set manually below. Otherwise, the parameters are looked up in the file <code class="docutils literal notranslate"><span class="pre">planet_database.py</span></code> using the name of the planet. Please feel free to add any new planets to this file.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">surface</span> <span class="pre">gravity</span> <span class="pre">[cm</span> <span class="pre">s^-2]</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the surface gravity value in cgs units. Although called ‘surface’ gravity, this constant value is used throughout the atmospheric grid. If the entered value &lt; 10, it is assumed that it is the log10 of the gravity, i.e., g = 10^(input value). <em>This parameter is only used if ‘manual’ is set for the planet.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">orbital</span> <span class="pre">distance</span> <span class="pre">[AU]</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the orbital distance between planet and host star in AU. <em>This parameter is only used if ‘manual’ is set for the planet.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">radius</span> <span class="pre">planet</span> <span class="pre">[R_Jup]</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the radius of the planet in Jupiter radii. <em>This parameter is only used if ‘manual’ is set for the planet.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">radius</span> <span class="pre">star</span> <span class="pre">[R_Sun]</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the radius of the star in solar radii. <em>This parameter is only used if ‘manual’ is set for the planet.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">temperature</span> <span class="pre">star</span> <span class="pre">[K]</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;=</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the temperature of the star in Kelvin. The stellar temperature is used if treating the star as a blackbody and for the energy budget correction (see below). <em>This parameter is only used if ‘manual’ is set for the planet.</em></p>
</div>
<div class="section" id="clouds">
<h3>Clouds<a class="headerlink" href="#clouds" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">cloud</span> <span class="pre">decks</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;=</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the number of clouds decks in the model. With ‘0’ the atmosphere is cloud-free.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">to</span> <span class="pre">Mie</span> <span class="pre">files</span>&#160;&#160; <span class="pre">[directory</span> <span class="pre">path(s)]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y,</span> <span class="pre">only</span> <span class="pre">1</span> <span class="pre">cloud)</span></code></p>
</div></blockquote>
<p>This sets the path to the directory with the Mie files that are used for the cloud extinction. A path has to be defined for each cloud deck. This parameter can be set via command-line but only for the case with a single cloud.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">aerosol</span> <span class="pre">radius</span> <span class="pre">mode</span> <span class="pre">[micron]</span>&#160;&#160; <span class="pre">[number(s)</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y,</span> <span class="pre">only</span> <span class="pre">1</span> <span class="pre">cloud)</span></code></p>
</div></blockquote>
<p>This sets the mode of the lognormal distribution that describes the aerosol radii. A mode has to be defined for each cloud deck. This parameter can be set via command-line but only for the case with a single cloud.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">aerosol</span> <span class="pre">radius</span> <span class="pre">geometric</span> <span class="pre">std</span> <span class="pre">dev</span>&#160;&#160; <span class="pre">[number(s)</span> <span class="pre">&gt;</span> <span class="pre">1]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y,</span> <span class="pre">only</span> <span class="pre">1</span> <span class="pre">cloud)</span></code></p>
</div></blockquote>
<p>This sets the geometric standard deviation of the lognormal distribution that describes the aerosol radii. Recall that this value &gt; 1, as a standard deviation of unity would mean that the distribution is infinitesimally thin. A standard deviation has to be defined for each cloud deck. This parameter can be set via command-line but only for the case with a single cloud.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">cloud</span> <span class="pre">mixing</span> <span class="pre">ratio</span>&#160;&#160; <span class="pre">[manual,</span> <span class="pre">file]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The vertical volume mixing ratio of the cloud can be set either manually below or read from a file. with the ‘manual’ setting the cloud is parameterized by the pressure at the bottom of the cloud, the mixing ratio at the bottom of the cloud and the cloud-to-gas scale height.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">to</span> <span class="pre">file</span> <span class="pre">with</span> <span class="pre">cloud</span> <span class="pre">data</span>&#160;&#160; <span class="pre">[file</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the file with the vertical cloud mixing ratio. <em>This parameter is only used if ‘file’ is set for the cloud mixing ratio.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">cloud</span> <span class="pre">file</span> <span class="pre">format</span>&#160;&#160; <span class="pre">[#</span> <span class="pre">header</span> <span class="pre">lines,</span> <span class="pre">pressure</span> <span class="pre">column,</span> <span class="pre">pressure</span> <span class="pre">unit</span> <span class="pre">[cgs,</span> <span class="pre">Pa,</span> <span class="pre">bar]]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">N)</span></code></p>
</div></blockquote>
<p>This sets the format of the file with the cloud mixing ratio. First parameter determines the number of lines skipped at the beginning of the file. Second one the name of the pressure column. Third one the pressure unit with ‘cgs’, ‘Pa’ and ‘bar’ being the options. <em>This parameter is only used if ‘file’ is set for the cloud mixing ratio.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">aerosol</span> <span class="pre">name</span>&#160;&#160; <span class="pre">[name(s)</span> <span class="pre">of</span> <span class="pre">column(s)</span> <span class="pre">with</span> <span class="pre">cloud</span> <span class="pre">data]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y,</span> <span class="pre">only</span> <span class="pre">1</span> <span class="pre">cloud)</span></code></p>
</div></blockquote>
<p>This sets the name of the column with the aerosol mixing ratio. A column name has to be set for each cloud deck. This parameter can be set via command-line but only for the case with a single cloud. <em>This parameter is only used if ‘file’ is set for the cloud mixing ratio.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">cloud</span> <span class="pre">bottom</span> <span class="pre">pressure</span> <span class="pre">[10^-6</span> <span class="pre">bar]</span>&#160;&#160; <span class="pre">[number(s)</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y,</span> <span class="pre">only</span> <span class="pre">1</span> <span class="pre">cloud)</span></code></p>
</div></blockquote>
<p>This sets the pressure at the bottom of the cloud, in cgs units. A pressure has to be set for each cloud deck. This parameter can be set via command-line but only for the case with a single cloud. <em>This parameter is only used if ‘manual’ is set for the cloud mixing ratio.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">cloud</span> <span class="pre">bottom</span> <span class="pre">mixing</span> <span class="pre">ratio</span>&#160;&#160; <span class="pre">[number(s):</span> <span class="pre">0</span> <span class="pre">--</span> <span class="pre">1]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y,</span> <span class="pre">only</span> <span class="pre">1</span> <span class="pre">cloud)</span></code></p>
</div></blockquote>
<p>This sets the volume mixing ratio for the cloud aerosols at the bottom of the cloud. A mixing ratio has to be set for each cloud deck. This parameter can be set via command-line but only for the case with a single cloud. <em>This parameter is only used if ‘manual’ is set for the cloud mixing ratio.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">cloud</span> <span class="pre">to</span> <span class="pre">gas</span> <span class="pre">scale</span> <span class="pre">height</span> <span class="pre">ratio</span>&#160;&#160; <span class="pre">[number(s)</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y,</span> <span class="pre">only</span> <span class="pre">1</span> <span class="pre">cloud)</span></code></p>
</div></blockquote>
<p>This sets the cloud-to-gas scale height ratio. E.g., if the scale height ratio is set to unity the cloud mixing ratio is constant with respect to the background gas. A scale height ratio has to be set for each cloud deck. This parameter can be set via command-line but only for the case with a single cloud. <em>This parameter is only used if ‘manual’ is set for the cloud mixing ratio.</em></p>
</div>
<div class="section" id="photochemical-kinetics-coupling">
<h3>Photochemical Kinetics Coupling<a class="headerlink" href="#photochemical-kinetics-coupling" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">coupling</span> <span class="pre">mode</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If enabled, activates the coupling mode which allows for additional coupling features. Also, the code generates additional output files that are useful for the coupling with a chemistry code. These files contain the coupling T-P profile and the coupling convergence criterion. See <a class="reference internal" href="structure.html"><span class="doc">Code Structure</span></a> for more info.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">full</span> <span class="pre">output</span> <span class="pre">each</span> <span class="pre">iteration</span> <span class="pre">step</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If enabled, all HELIOS output files are stored for each coupling iteration step. In order to avoid the files being overwritten the iteration step is appended to the name of the HELIOS run. Otherwise, only the coupling T-P profile and the convergence criterion are kept for each iteration step and everything else is being overwritten. <em>This parameter is only used if ‘yes’ is set for the coupling mode.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">force</span> <span class="pre">eq</span> <span class="pre">chem</span> <span class="pre">for</span> <span class="pre">first</span> <span class="pre">iteration</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If enabled, the mixing ratio setting ‘file’ in the species file is overridden and FastChem is used instead for the very first coupling iteration step. The idea behind this is that for the first iteration the vertical chemistry has not beed calculated yet and thus equilibrium chemistry has to be assumed. And with this setting one does not manually have to modify the species file to do that. This does not affect the the constant mixing ratios set in the species file. <em>This parameter is only used if ‘yes’ is set for the coupling mode.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">coupling</span> <span class="pre">speed</span> <span class="pre">up</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If enabled, instead of feeding the newest T-P profile to the chemistry code, HELIOS takes the average from the newest and previous T-P profiles. From experience this reduces the number of iterations until convergence because what usually happens is that the iteration oscillates around the equilibrium state. Taking the average thus progresses the iteration faster to the equilibrium state. Note that this has not been thoroughly tested, so use cautiously. <em>This parameter is only used if ‘yes’ is set for the coupling mode.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">coupling</span> <span class="pre">iteration</span> <span class="pre">step</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;=</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the coupling iteration step. In practically all circumstances this will be set via command-line. <em>This parameter is only used if ‘yes’ is set for the coupling mode.</em></p>
</div>
<div class="section" id="advanced-settings">
<h3>Advanced Settings<a class="headerlink" href="#advanced-settings" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">debugging</span> <span class="pre">feedback</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This activates some additional warnings during the RT calculation, e.g., if a flux becomes negative and similar. This <em>may</em> indicate that there is an issue with the calculation (or it could simply be a limitation of numerical precision). If you don’t know what do to with these warnings, you might as well keep them switched off – and sleep better.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">precision</span>&#160;&#160; <span class="pre">[double,</span> <span class="pre">single]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This changes the numerical precision used for the GPU calculations. However, I have never found any difference in terms of accuracy or speed when switching between single and double precision. (Perhaps I did something wrong). It is probably the best to leave it at ‘double’.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">layers</span>&#160;&#160; <span class="pre">[automatic,</span> <span class="pre">number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the number of layers in the vertical grid between BOA and TOA. Either a constant number can be set manually or with ‘automatic’ the number of layers is 10 per order of magnitude in pressure. The latter has been found a good compromise between vertical resolution, computational speed and numerical stability.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">isothermal</span> <span class="pre">layers</span>&#160;&#160; <span class="pre">[automatic,</span> <span class="pre">yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Using a single temperature (‘yes’) or a blackbody gradient (‘no’) over the width of each layer. Recommended: ‘yes’ for spectral post-processing and ‘no’ for iterative mode. With ‘automatic’ the recommended settings are taken depending on the run type.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">adaptive</span> <span class="pre">interval</span>&#160;&#160; <span class="pre">[number]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Number of iterative steps over which oscillations are analyzed (see Sect. 2.2.4. in <a class="reference external" href="http://adsabs.harvard.edu/abs/2017AJ....153...56M">Malik et al. 2017</a>). The smaller the number the faster the convergence. However, a too small number may be numerically unstable. Tested range of values: 6 – 20.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">TP</span> <span class="pre">profile</span> <span class="pre">smoothing</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This functionality smoothes sharp kinks in the T-P profile at the cost of local energy balance in the smoothed regions (see App. C in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019AJ....157..170M/">Malik et al. 2019</a>). This should be switched off per default and only activated if kinks are detected.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">improved</span> <span class="pre">two</span> <span class="pre">stream</span> <span class="pre">correction</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Activates the improved two-stream scattering correction (I2S) from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018ApJS..237...29H">Heng et al. (2018)</a>. In theory, this makes the scattering more accurate. Unfortunately, the I2S breaks down in the deep, optically thick atmosphere when scattering becomes negligible. Thus to avoid using the I2S in this regime a switch is implemented that turns off the I2S (using regular two-stream instead) beyond the transition point (see next parameter). Per default the I2S is switched off and should only be used when the limitations of this method are understood.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">I2S</span> <span class="pre">transition</span> <span class="pre">point</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">between</span> <span class="pre">0</span> <span class="pre">and</span> <span class="pre">1]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the value of the single scattering albedo w_0 that is used for the transition between I2S and regular two-stream. In the atmosphere whenever w_0 &gt; transition point I2S is used, otherwise regular two-stream formalism is used. <em>This parameter is only used if ‘yes’ is set for the improved two stream correction.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">asymmetry</span> <span class="pre">factor</span> <span class="pre">g_0</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">between</span> <span class="pre">-1</span> <span class="pre">and</span> <span class="pre">1]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the orientation of the scattering. Setting g_0 = 1 means all scattering is purely forward, g_0 = -1 leads to pure backward scattering and g_0 = 0 means isotropic scattering. When modeling cloud-free conditions with only gaseous Rayleigh scattering, it is recommended to set g_0 = 0.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">diffusivity</span> <span class="pre">factor</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">between</span> <span class="pre">1</span> <span class="pre">and</span> <span class="pre">2]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This factor determines how diffuse radiation is. It is also the inverse of the first Eddington coefficient that the ratio between the total flux and the total intensity (see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2014ApJS..215....4H">Heng et al. 2014</a>). Setting D = 2 means that the radiation is isotropic. This value recovers the correct fluxes in the deep, opaque atmosphere where the fluxes consists of isotropic blackbody radiation. However, around the photosphere and adjacent optically thinner atmosphere the radiation will be non-isotropic because the extinction of radiation is dependent on the angle of propagation and the diffusivity factor should be &lt; 2. For instance, <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2014A%2526A...564A..59A">Amundsen et al. (2016)</a> recommend D = 1.66. However, in <a class="reference external" href="http://adsabs.harvard.edu/abs/2017AJ....153...56M">Malik et al. (2017)</a> we found that D = 2 most closely reproduces the “exact” fluxes in the pure absorption limit (see Fig. 11 in that paper) and so per default D = 2 is set.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">second</span> <span class="pre">Eddington</span> <span class="pre">coefficient</span>&#160;&#160; <span class="pre">[number]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The second Eddington coefficient (e2) sets the strength of the coupling between the direct irradiation beam and the diffuse fluxes via scattering. Per default, this coefficient is set to 0.5 which is consistent with the flux solutions in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019AJ....157..170M/">Malik et al. 2019</a>. Another possibility is setting e2 = 2/3, consistent with the Eddington closure, or e2 = 1/sqrt(3), consistent with the quadrature closure (see discussion in Sect. 4.3. of <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018ApJS..237...29H">Heng et al. 2018</a>).</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">geometric</span> <span class="pre">zenith</span> <span class="pre">angle</span> <span class="pre">correction</span>&#160;&#160; <span class="pre">[automatic,</span> <span class="pre">yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If disabled, the zenith angle is assumed to be constant throughout the atmosphere. However, due to the planet’s spherical geometry, the angle is in fact dependent on the altitude. The correction is only important for large zenith angles in regions close to the terminator (see Sect. 4.4. in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019AJ....157..170M/">Malik et al. 2019</a>). Hence, when set to ‘automatic’ the correction is applied to zenith angles &gt;= 70 deg, but switched off otherwise to keep the computational costs lower.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">flux</span> <span class="pre">calculation</span> <span class="pre">method</span>&#160;&#160; <span class="pre">[iteration,</span> <span class="pre">matrix]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The radiative fluxes are coupled via scattering and thus to solve for the coupled fluxes that are converged (i.e., after an infinite number of scattering processes occured) two methods can be used. The first method is a simple iteration, multiple times through the vertical grid. Each iteration populates the fluxes and brings them closer to their final and converged values. Currently, HELIOS iterates 3 times for each time step during the iterative mode and 1000 times during post-processing to reach a converged state. Alternatively, the flux problem can be written as tridiagonal matrix and solved via the standard <a class="reference external" href="https://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm">Thomas algorithm</a>. In theory, the matrix algorithm would be the preferred way to calculate the fluxes as it is somewhat faster than the flux iteration method (for post-processing only though) and, as the final fluxes are obtained instantaneously, is expected to be the more accurate method. Unfortunately, after extensive testing the matrix method has been found numerically unstable in a number of cases: (i) if the scattering contribution is very minor, (ii) if the the atmospheric optical depth is large or (iii) if the BOA has a vanishing albedo. In all of these cases the fluxes become uncoupled, creating singularities in the matrix algorithm. This deficit is well known in the literature and discussed, e.g., on page 16,291 of <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1989JGR....9416287T">Toon et al. (1989)</a>. For this reason, it is recommended to use the iterative solver for the fluxes.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">coefficients</span> <span class="pre">mixing</span> <span class="pre">method</span>&#160;&#160; <span class="pre">[correlated-k,</span> <span class="pre">RO]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>When the k-distribution method is used, approximations have to be made in order to mix the k-coefficient of multiple gas species. The correlated-k method assumes that the absorption bands of different gas species are perfectly correlated so that their k-coefficients at given abscissa coordinate can straightforwardly be summed up (as we did in <a class="reference external" href="http://adsabs.harvard.edu/abs/2017AJ....153...56M">Malik et al. 2017</a>). A more accurate albeit much slower numerical scheme is to assume a random correlation (also called random overlap, RO) between the absorption bands of different gas species (see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1991JGR....96.9027L">Lacis &amp; Oinas 1991</a>). In HELIOS the RORR (RO with resorting and rebinning) scheme from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2017A%2526A...598A..97A">Amundsen et al. (2016)</a>) is incorporated. Strictly speaking, RO still assumes a certain correlation between absorption bands, not between different species, but by assuming that the absorption bands remain at the same wavelengths when moving vertically through the atmosphere. It is recommended to use RO per default.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">energy</span> <span class="pre">budget</span> <span class="pre">correction</span>&#160;&#160; <span class="pre">[automatic,</span> <span class="pre">yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This correction shifts the incoming stellar flux to produce the correct Stefan-Boltzmann value when integrating over all wavelengths. This is necessary because due to limits on the wavelength range of the model some fraction of the external radiation may not be accounted for. As a rule of thumb, this should be switched on for iterative runs (where the total energy budget of the atmosphere is important) and switched off for post-processing purposes (where the exact flux value at a given wavelength is important), and that is what happens when ‘automatic’ is set.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">convective</span> <span class="pre">damping</span> <span class="pre">parameter</span>&#160;&#160; <span class="pre">[automatic,</span> <span class="pre">number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Parameter that damps the shift of the temperatures in the convective zone, as described in App. D of <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019AJ....157..170M/">Malik et al. (2019)</a>. It should be left as ‘automatic’, but can also be set to a constant number if the code becomes stuck at the convective adjustment stage. If global energy equilibrium cannot be reached but the net flux is constant throughout the vertical grid, the damping needs to be made weaker by choosing a small parameter. If the model is unstable with the net fluxes not converging to a constant value the damping needs to be made stronger by choosing a smaller parameter. Typical values of this parameter are 0.5 – 8.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">plancktable</span> <span class="pre">dimension</span> <span class="pre">and</span> <span class="pre">stepsize</span>&#160;&#160; <span class="pre">[two</span> <span class="pre">numbers</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">N)</span></code></p>
</div></blockquote>
<p>In order to speed up iteration, the code pre-calculates blackbody flux values for a temperature grid at the beginning of each run. The first parameter here sets the number of temperature points and the second parameter the linear step size. Per default these numbers are 8000 and 2, creating a grid starting at 1 K and going to 15999 K with a step size of 2 K. To save memory a viable smaller grid could be 800 and 5, creating a grid over 1 K – 3996 K. <strong>Important(!)</strong>: the temperature grid must encompass the whole range of temperatures that are encountered during the model run, otherwise the code breaks down.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">maximum</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">iterations</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Maximum number of iterations after which the code stops even if equilibrium is not reached. This is simply to prevent a ‘hung’ job from running indefinitely.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">radiative</span> <span class="pre">equilibrium</span> <span class="pre">criterion</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>The relative flux limit below which radiative equilibrium is assumed. This limit is compared to the ratio abs(F_net[i+1] – F_int) / (F_down[TOA] + F_int) for each layer i. This criterion needs to be satisfied in all radiative layers. Global equilibrium is naturally included once all radiative layers are in local equilibrium.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">relax</span> <span class="pre">radiative</span> <span class="pre">criterion</span> <span class="pre">at</span>&#160;&#160; <span class="pre">[two</span> <span class="pre">numbers</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">N)</span></code></p>
</div></blockquote>
<p>After these numbers of iteration the radiative equilibrium criterion is multiplied by a factor of 10. Once the criterion has been relaxed the model outcome is less accurate, but the relaxation helps to converge ‘stubborn’ models. If the criterion has been relaxed the additional file ‘_convergence_warning.dat’ is written which lists the final criterion used. Using default values (and initial criterion of 1e-8), even when relaxing twice, the final criterion is still 1e-6 and the results sufficiently accurate in the vast majority of cases.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">prerun</span> <span class="pre">timesteps</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;=</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Number of iterations before the temperature starts evolving. This is really only useful for movie-making purposes.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">physical</span> <span class="pre">timestep</span> <span class="pre">[s]</span>&#160;&#160; <span class="pre">[no,</span> <span class="pre">number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>Under normal circumstances this is set to ‘no’ and a numerical forward stepping is used in order to quickly reach radiative-convective equilibrium. However, HELIOS can also use a constant, physical time stepping which is activated when setting this parameter to a number, which is the value of the constant time step.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">runtime</span> <span class="pre">limit</span> <span class="pre">[s]</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">timestep]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If physical time stepping is active, this sets the runtime limit in seconds. The code runs either until rad.-conv. equilibrium or the time limit is reached. <em>This parameter is only used if a number is set for the physical timestep and physical timestepping is thus activated.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">start</span> <span class="pre">from</span> <span class="pre">provided</span> <span class="pre">TP</span> <span class="pre">profile</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>If enabled, it forces the code to start from a provided T-P profile. This is used to continue a previous run. Since normal runs with numerical forward stepping should always converge, this is really only relevant when using physical time stepping, and so –&gt; <em>This parameter is only used if a number is set for the physical timestep and physical timestepping is thus activated.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">include</span> <span class="pre">additional</span> <span class="pre">heating</span>&#160;&#160; <span class="pre">[yes,</span> <span class="pre">no]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This enables the use of additional heating terms that are provided via file.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">to</span> <span class="pre">heating</span> <span class="pre">file</span>&#160;&#160; <span class="pre">[file</span> <span class="pre">path]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the path to the file with the heating terms as a function of pressure. <em>This parameter is only used if ‘include additional heating’ is set to ‘yes’.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">heating</span> <span class="pre">file</span> <span class="pre">format</span>&#160;&#160; <span class="pre">[#</span> <span class="pre">header</span> <span class="pre">lines,</span> <span class="pre">pressure</span> <span class="pre">column,</span> <span class="pre">pressure</span> <span class="pre">unit</span> <span class="pre">[cgs,</span> <span class="pre">SI,</span> <span class="pre">bar],</span> <span class="pre">data</span> <span class="pre">column,</span> <span class="pre">conversion</span> <span class="pre">factor</span> <span class="pre">to</span> <span class="pre">cgs]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">N)</span></code></p>
</div></blockquote>
<p>This sets the format of the file with the heating terms. First parameter determines the number of lines skipped at the beginning of the file. Second one the name of the pressure column. Third one the pressure unit with ‘cgs’, ‘Pa’ and ‘bar’ being the options. Next, the name of the column with the heating data. The heating must be given as power density (i.e., energy / unit time / unit volume). The last parameter is the factor that converts the heating terms to cgs units, i.e., to erg s^-1 cm^-3. <em>This parameter is only used if ‘include additional heating’ is set to ‘yes’.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">write</span> <span class="pre">TP</span> <span class="pre">profile</span> <span class="pre">during</span> <span class="pre">run</span>&#160;&#160; <span class="pre">[no,</span> <span class="pre">number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This enables the writing of the current T-P profile during the forward iteration. If set to ‘no’, the write-out is disabled. Otherwise the step interval at which the T-P profile is written can be set here. This functionality is used to speed up the coupling because for the first few iterations the T-P profile fed to the chemistry code does not need to be in full equilibrium. <em>This parameter is only used if coupling mode is set to ‘yes’.</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">convergence</span> <span class="pre">criterion</span>&#160;&#160; <span class="pre">[number</span> <span class="pre">&gt;</span> <span class="pre">0]</span>&#160;&#160; <span class="pre">(CL:</span> <span class="pre">Y)</span></code></p>
</div></blockquote>
<p>This sets the relative limit on the temperature difference between successive coupling iterations below which a convergence is assumed. This limit is compared T_previous[i] – T_current[i] / T_current[i] for each layer i. <em>This parameter is only used if coupling mode is set to ‘yes’.</em></p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_l.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">GPU-accelerated radiative transfer code for exoplanetary atmospheres</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=exoclime&repo=helios&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html"><strong>About</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html"><strong>Requirements</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html"><strong>Tutorial</strong></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><strong>Input Parameters</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-info">General Info</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameter-file">Parameter File</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="#grid">Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iteration">Iteration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#radiation">Radiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#opacity-mixing">Opacity Mixing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convective-adjustment">Convective Adjustment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stellar-and-planetary-parameters">Stellar and Planetary Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clouds">Clouds</a></li>
<li class="toctree-l3"><a class="reference internal" href="#photochemical-kinetics-coupling">Photochemical Kinetics Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-settings">Advanced Settings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="structure.html"><strong>Code Structure</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="ktable.html"><strong>ktable Program</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html"><strong>License</strong></a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018-2022, Matej Malik.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/sections/parameters.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>